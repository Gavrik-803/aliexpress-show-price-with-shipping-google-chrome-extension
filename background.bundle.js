(()=>{var r={135:(r,t,e)=>{r.exports=e(248)},248:r=>{var t=function(r){"use strict";var t,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(r,t,e){return Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),r[t]}try{u({},"")}catch(r){u=function(r,t,e){return r[t]=e}}function s(r,t,e,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),i=new N(n||[]);return a._invoke=function(r,t,e){var n=f;return function(o,a){if(n===p)throw new Error("Generator is already running");if(n===v){if("throw"===o)throw a;return j()}for(e.method=o,e.arg=a;;){var i=e.delegate;if(i){var c=L(i,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=v,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=p;var u=h(r,t,e);if("normal"===u.type){if(n=e.done?v:l,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=v,e.method="throw",e.arg=u.arg)}}}(r,e,i),a}function h(r,t,e){try{return{type:"normal",arg:r.call(t,e)}}catch(r){return{type:"throw",arg:r}}}r.wrap=s;var f="suspendedStart",l="suspendedYield",p="executing",v="completed",y={};function m(){}function d(){}function g(){}var w={};w[a]=function(){return this};var x=Object.getPrototypeOf,b=x&&x(x(S([])));b&&b!==e&&n.call(b,a)&&(w=b);var E=g.prototype=m.prototype=Object.create(w);function k(r){["next","throw","return"].forEach((function(t){u(r,t,(function(r){return this._invoke(t,r)}))}))}function _(r,t){function e(o,a,i,c){var u=h(r[o],r,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(r){e("next",r,i,c)}),(function(r){e("throw",r,i,c)})):t.resolve(f).then((function(r){s.value=r,i(s)}),(function(r){return e("throw",r,i,c)}))}c(u.arg)}var o;this._invoke=function(r,n){function a(){return new t((function(t,o){e(r,n,t,o)}))}return o=o?o.then(a,a):a()}}function L(r,e){var n=r.iterator[e.method];if(n===t){if(e.delegate=null,"throw"===e.method){if(r.iterator.return&&(e.method="return",e.arg=t,L(r,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,r.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var a=o.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,y):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function O(r){var t={tryLoc:r[0]};1 in r&&(t.catchLoc=r[1]),2 in r&&(t.finallyLoc=r[2],t.afterLoc=r[3]),this.tryEntries.push(t)}function P(r){var t=r.completion||{};t.type="normal",delete t.arg,r.completion=t}function N(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(O,this),this.reset(!0)}function S(r){if(r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}return{next:j}}function j(){return{value:t,done:!0}}return d.prototype=E.constructor=g,g.constructor=d,d.displayName=u(g,c,"GeneratorFunction"),r.isGeneratorFunction=function(r){var t="function"==typeof r&&r.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,g):(r.__proto__=g,u(r,c,"GeneratorFunction")),r.prototype=Object.create(E),r},r.awrap=function(r){return{__await:r}},k(_.prototype),_.prototype[i]=function(){return this},r.AsyncIterator=_,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var i=new _(s(t,e,n,o),a);return r.isGeneratorFunction(e)?i:i.next().then((function(r){return r.done?r.value:i.next()}))},k(E),u(E,c,"Generator"),E[a]=function(){return this},E.toString=function(){return"[object Generator]"},r.keys=function(r){var t=[];for(var e in r)t.push(e);return t.reverse(),function e(){for(;t.length;){var n=t.pop();if(n in r)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=S,N.prototype={constructor:N,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(r,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===r||"continue"===r)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=r,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(r,t){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&t&&(this.next=t),y},finish:function(r){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===r)return this.complete(e.completion,e.afterLoc),P(e),y}},catch:function(r){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===r){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:S(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),y}},r}(r.exports);try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}}},t={};function e(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return r[n](a,a.exports,e),a.exports}e.n=r=>{var t=r&&r.__esModule?()=>r.default:()=>r;return e.d(t,{a:t}),t},e.d=(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},e.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t),(()=>{"use strict";function r(r,t,e,n,o,a,i){try{var c=r[a](i),u=c.value}catch(r){return void e(r)}c.done?t(u):Promise.resolve(u).then(n,o)}function t(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function c(t){r(i,o,a,c,u,"next",t)}function u(t){r(i,o,a,c,u,"throw",t)}c(void 0)}))}}var n=e(135),o=e.n(n);function a(r,e){return new Promise(function(){var n=t(o().mark((function t(n,a){var i,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://panel.sconnect.plus/api/v1.1".concat(r),{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)});case 3:return i=t.sent,t.next=6,i.json();case 6:return c=t.sent,t.abrupt("return",n(c));case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",a({result:!1,error:t.t0}));case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(r,t){return n.apply(this,arguments)}}())}const i=function(){chrome.runtime.onMessage.addListener((function(r,e,n){switch(r.command){case"requestSender":return(i=r,c=i.url,u=i.data,s=void 0===u?{}:u,new Promise(function(){var r=t(o().mark((function r(e,n){var i,u,h,f;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,c){r.next=3;break}return r.abrupt("return",n({result:!1,error:"url is empty"}));case 3:return r.next=5,new Promise(function(){var r=t(o().mark((function r(t,e){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:chrome.storage.local.get(["token"],(function(r){return chrome.runtime.lastError?e({result:!1,error:chrome.runtime.lastError}):t({token:r.token})}));case 1:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}());case 5:return i=r.sent,u=i.token,s.token=u,r.next=10,a(c,s);case 10:if(2!==(h=r.sent).status_error){r.next=22;break}if("SCONNECT_BAD_TOKEN"!==h.code){r.next=22;break}return r.next=15,new Promise(function(){var r=t(o().mark((function r(e,n){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:chrome.storage.local.get(["refreshToken"],function(){var r=t(o().mark((function r(t){var a,i;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!chrome.runtime.lastError){r.next=3;break}return r.abrupt("return",n({result:!1,error:chrome.runtime.lastError}));case 3:return r.next=5,fetch("https://panel.sconnect.plus/api/v1.1/refresh",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({refresh:t.refreshToken})});case 5:return a=r.sent,r.next=8,a.json();case 8:if("SCONNECT_SUCCESS_REFRESHED_TOKEN"!==(i=r.sent).code){r.next=13;break}chrome.storage.local.set({access_token:i.access_token},(function(){return chrome.runtime.lastError?n({result:!1,error:chrome.runtime.lastError}):e({result:!0,token:i.access_token})})),r.next=14;break;case 13:return r.abrupt("return",n({result:!1,error:i.code}));case 14:r.next=19;break;case 16:return r.prev=16,r.t0=r.catch(0),r.abrupt("return",n({result:!1,error:r.t0.message}));case 19:case"end":return r.stop()}}),r,null,[[0,16]])})));return function(t){return r.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}());case 15:if(!0!==(f=r.sent).result||!f.token){r.next=22;break}return s.token=f.token,r.next=20,a(c,s);case 20:"SCONNECT_BAD_TOKEN"===(h=r.sent).code&&chrome.storage.local.set({stepMain:2},(function(){return chrome.runtime.lastError?n({result:!1,error:chrome.runtime.lastError}):(chrome.browserAction.setPopup({popup:"auth.html"}),e({result:!1,error:"show_auth"}))}));case 22:return r.abrupt("return",e(h));case 25:return r.prev=25,r.t0=r.catch(0),r.abrupt("return",n({result:!1,error:r.t0}));case 28:case"end":return r.stop()}}),r,null,[[0,25]])})));return function(t,e){return r.apply(this,arguments)}}())).then((function(r){return n(r)})).catch((function(r){return n((t=r,console.error(t),chrome.browserAction.setPopup({popup:"error.html"}),{result:!1,error:"show_error"}));var t})),!0}var i,c,u,s}))};function c(){return(c=t(o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i();case 1:case"end":return r.stop()}}),r)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()})()})();