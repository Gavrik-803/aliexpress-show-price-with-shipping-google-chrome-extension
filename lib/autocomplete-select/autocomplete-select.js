import"./select.css";class AutoSelect{constructor(){}autoSelect(){let e=document.querySelectorAll(".selector");for(let t=0;t<e.length;t++){let a=e[t],r=a.querySelector("input");if(r.hasAttribute("autoCompleteActivated"))continue;r.setAttribute("autoCompleteActivated","true"),r.addEventListener("keyup",(e=>{this.searchEvent(e)})),r.addEventListener("search",(e=>{this.removeSearch(e)}));let l=a.querySelector(".data-container"),c=document.querySelector("main"),n=a.querySelector(".data"),s=r.getBoundingClientRect().bottom;n.style.maxHeight=500-s+"px",a.addEventListener("mouseenter",(e=>{l.style.display="block",r.classList.add("open");let t=l.offsetHeight,a=document.documentElement.clientHeight-s;a<t&&(c.style.height=`${c.offsetHeight+(t-a)}px`)})),a.addEventListener("mouseleave",(e=>{l.style.display="none",r.classList.remove("open"),c.style.height="auto"})),Array.from(l.querySelectorAll(".option")).forEach(((e,t)=>{e.addEventListener("click",(e=>{this.selectElement(e)}))}))}}addSearch(e){let t=new RegExp(e.target.value,"i"),a=e.target.parentNode.querySelectorAll(".option");Array.from(a).forEach((e=>{-1===e.innerText.search(t)?e.hidden=!0:e.hidden=!1}))}removeSearch(e){let t=new RegExp(e.target.value,"i"),a=e.target.parentNode.querySelectorAll(".option");Array.from(a).forEach(((e,a)=>{-1!==e.innerText.search(t)?e.hidden=!1:e.hidden=!0}))}searchEvent(e){"Backspace"===e.code||"Escape"===e.code?this.removeSearch(e):this.addSearch(e)}selectElement(e){let t;for(let a=0;a<e.path.length;a++){const r=e.path[a];if("classList"in r&&r.classList.contains("selector")){t=r;break}}let a=t.querySelector("input"),r=t.querySelector(".data-container");a.value=e.target.textContent;for(let t in e.target.dataset)a.dataset[t]=e.target.dataset[t];let l=t.querySelector(".option.selected");l&&l.classList.remove("selected"),e.target.classList.add("selected"),r.style.display="none",this.onSelected({event:e,data:a.dataset,textValue:a.value})}createStructure(){let e=document.createElement("div");e.classList.add("selector");let t=document.createElement("input");t.type="search";let a=document.createElement("div");a.classList.add("error");let r=document.createElement("div");r.classList.add("data-container");let l=document.createElement("div");return l.classList.add("data"),r.append(l),e.append(t),e.append(a),e.append(r),e}onSelected(){}}export default AutoSelect;